<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<iframe id="iframe" src="http://127.0.0.1:8848/SSO/index.html" style="display: none;"></iframe>
		<input type="button" value="登录" id="loginBtn" />
		
		
		
		
		<script>
		let iframe = document.getElementById('iframe');
		// 本网页的网址
		let url = 'http://127.0.0.1:8848/test/login.html';
		// 向SSO发送zyyz进行验证有没有登录
		sendMessage("zyyz")
		// 接受SSO返回数据
		window.addEventListener('message',(e) => {
			//0，没有进行登录。1，已经登录过
		    if(e.data == '0'){
				console.log("没有登录");
				
			}else{
				console.log("已经登录过了");
				window.location.href='index.html'
			}
		}, false);
		
			//没有登录，进行登录操作
			var btn = document.getElementById('loginBtn');
			btn.addEventListener('click', function (e) {
				e.preventDefault();
				console.log("开始登录");
				let data = 'message,'+'admin,admin'
				iframe.contentWindow.postMessage(data, url);
				window.addEventListener('message',(e) => {
				    console.log(e.data);
				}, false);
			});
		 /**
		  * 向SSO发送数据
		  * */
		 function sendMessage(message){
			 
			 iframe.onload = function() {
			    iframe.contentWindow.postMessage(message, url);
			 };
		 }
		
		</script>
	</body>
</html>
